!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}e.exports=function(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"DIRECTION_LEFT",function(){return a}),n.d(t,"DIRECTION_RIGHT",function(){return c}),n.d(t,"DIRECTION_UP",function(){return l}),n.d(t,"DIRECTION_DOWN",function(){return d}),n.d(t,"default",function(){return f});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(6),a="DIRECTION_LEFT",c="DIRECTION_RIGHT",l="DIRECTION_UP",d="DIRECTION_DOWN",f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.left,i=void 0===n?"ArrowLeft":n,o=t.right,s=void 0===o?"ArrowRight":o,u=t.up,a=void 0===u?"ArrowUp":u,c=t.down,l=void 0===c?"ArrowDown":c;r()(this,e),this.app=null,this.direction=null,this.keysPressed={},this.kLeft=i,this.kRight=s,this.kUp=a,this.kDown=l,this.init()}return s()(e,[{key:"init",value:function(){var e=this;window.addEventListener("keydown",function(t){if(e.app.state===u.STATE_PAUSED||e.app.state===u.STATE_STOPPED)return!1;e.keyDown(t)}),window.addEventListener("keyup",function(t){if(e.app.state===u.STATE_PAUSED||e.app.state===u.STATE_STOPPED)return!1;e.keyUp(t)})}},{key:"keyDown",value:function(e){this.keysPressed[e.code]=performance.now(),this.selectDirection()}},{key:"keyUp",value:function(e){this.keysPressed[e.code]=0,this.selectDirection()}},{key:"selectDirection",value:function(){var e=this,t=null,n=0;switch(Object.keys(this.keysPressed).forEach(function(i){var r=e.keysPressed[i];(!n&&r||n&&r&&r>n)&&(t=i,n=r)}),t){case this.kLeft:this.direction=a;break;case this.kRight:this.direction=c;break;case this.kUp:this.direction=l;break;case this.kDown:this.direction=d}}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return a});var i=n(0),r=n.n(i),o=n(1),s=n.n(o);function u(e){var t=Math.round(Math.random()*(e.size.x-1))*e.cellSize,n=Math.round(Math.random()*(e.size.y-1))*e.cellSize;return new a(t,n)}var a=function(){function e(t,n){r()(this,e),this.x=t,this.y=n}return s()(e,null,[{key:"generate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=u(e.field),i=null;if(!t)for(;!i;)e.coordsIntersectingWithSnakes(n)?n=u(e.field):i=n;return i||n}}]),e}()},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){"use strict";n.r(t),n.d(t,"STATE_INITIALIZED",function(){return h}),n.d(t,"STATE_PAUSED",function(){return p}),n.d(t,"STATE_RUNNING",function(){return v}),n.d(t,"STATE_STOPPED",function(){return y}),n.d(t,"default",function(){return k});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(4),a=n.n(u),c=n(14),l=n(11),d=n(2),f=n(13),h="STATE_INITIALIZED",p="STATE_PAUSED",v="STATE_RUNNING",y="STATE_STOPPED",k=function(){function e(t){var n=this,i=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).debug,o=void 0!==i&&i;r()(this,e),a()(this,"tick",function(e){var t=n.setDelta(e);n.update(t),n.render(t),n.onTickEnd(),n.state!==y&&(n.reqAnimationFrame=window.requestAnimationFrame(n.tick))}),this.field=t,this.snakes=[],this.state=h,this.reqAnimationFrame=null,this.debug=o,this.then=0,this.started=!1,this.gameover=!1,this.onTickEndCallbacks=[],this.food=[],this.field.app=this,this.init()}return s()(e,[{key:"init",value:function(){var e=this;window.addEventListener("keypress",function(t){e.appControl(t)}),window.addEventListener("blur",function(){e.stop()}),window.addEventListener("visibilitychange",function(){"visible"===document.visibilityState?e.start():e.stop()}),window.addEventListener("focus",function(){e.start()})}},{key:"addSnake",value:function(){if(this.snakes.length){if(1===this.snakes.length){var e=new d.default({left:"KeyA",right:"KeyD",up:"KeyW",down:"KeyS"}),t=new f.default(this,e,{color:"red"});this.snakes.push(t),t.spawn()}}else{var n=new d.default,i=new f.default(this,n);this.snakes.push(i),i.spawn()}}},{key:"appControl",value:function(e){switch(e.code){case"Space":switch(this.state){case v:this.pause();break;case p:this.start()}break;case"Enter":this.addSnake()}}},{key:"start",value:function(){this.gameover||(this.state=v,this.reqAnimationFrame||(this.then=performance.now(),this.reqAnimationFrame=window.requestAnimationFrame(this.tick)))}},{key:"pause",value:function(){this.state=p}},{key:"stop",value:function(){window.cancelAnimationFrame(this.reqAnimationFrame),this.reqAnimationFrame=null,this.state=y}},{key:"setDelta",value:function(e){var t=e-this.then;return this.then=e,t}},{key:"update",value:function(e){this.generateFood(),this.snakes.forEach(function(t){return t.tick(e)})}},{key:"render",value:function(e){this.field.draw(e)}},{key:"generateFood",value:function(){if(!this.food.length){var e=new c.default(this);this.food.push(e)}}},{key:"cellIntersectingWithObstacles",value:function(e,t){return this.coordsIntersectingWithSnakes(t)?this.gameOver(e):!this.field.endless&&(!!this.coorsOutsideField(t)&&this.gameOver(e))}},{key:"killSnake",value:function(e){var t=this.snakes.findIndex(function(t){return t===e});this.snakes.splice(t,1)}},{key:"gameOver",value:function(e){return this.snakes.length>1?this.killSnake(e):(this.gameover=!0,this.stop(),this.onTickEnd(this.field.gameOver),l.default.checkScore(this.snakes[0].score)),!0}},{key:"onTickEnd",value:function(e){e?this.onTickEndCallbacks.push(e):(this.onTickEndCallbacks.forEach(function(e){return e()}),this.onTickEndCallbacks=[])}},{key:"coorsOutsideField",value:function(e){return e.x<0||e.x>=this.field.width||e.y<0||e.y>=this.field.height}},{key:"coordsIntersectingWithSnakes",value:function(e){var t=!1;return this.snakes.forEach(function(n){t||n.body.forEach(function(n){e.x===n.coords.x&&e.y===n.coords.y&&(t=!0)})}),t}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return a});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(3),a=function(){function e(t){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).animationSpeed,i=void 0===n?0:n;r()(this,e),this.coords=t,this.msPassed=0,this.animationSpeed=i}return s()(e,[{key:"tick",value:function(e){this.msPassed+=e,this.animationSpeed?this.deTick(this.update):this.update()}},{key:"deTick",value:function(e){this.msPassed>=this.animationSpeed&&(this.msPassed=this.msPassed-this.animationSpeed,e(),this.deTick(e))}},{key:"update",value:function(){}}],[{key:"generate",value:function(t){return new e(u.default.generate(t))}}]),e}()},function(e,t,n){var i=n(16),r=n(5);e.exports=function(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?r(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var i=n(17);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return u});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=function(){function e(){r()(this,e)}return s()(e,null,[{key:"checkScore",value:function(t){if(t){var n=e.score,i=n.length?-1:0;n.forEach(function(e,n){var r=e.points;i<0&&t>r&&(i=n)}),e.addScore(t,i)}}},{key:"addScore",value:function(t,n){var i=prompt("Whats your name?");if(i){var r={name:i,points:t,date:new Date},o=e.score;n<0?o.push(r):o.splice(n,0,r),o.length>5&&o.pop(),localStorage.setItem("snaked-score",JSON.stringify(o))}}},{key:"score",get:function(){var e=localStorage.getItem("snaked-score")||"[]",t=null;try{t=JSON.parse(e)}catch(e){t=[]}return t}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return d});var i=n(0),r=n.n(i),o=n(8),s=n.n(o),u=n(9),a=n.n(u),c=n(10),l=n.n(c),d=function(e){function t(){return r()(this,t),s()(this,a()(t).apply(this,arguments))}return l()(t,e),t}(n(7).default)},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return v});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(4),a=n.n(u),c=n(18),l=n.n(c),d=n(6),f=n(2),h=n(3),p=n(12),v=function(){function e(t,n){var i=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=o.speed,u=void 0===s?5:s,c=o.toGrow,p=void 0===c?2:c,v=o.color,y=void 0===v?"black":v;r()(this,e),a()(this,"move",function(){if(i.app.state!==d.STATE_RUNNING)return!1;var e=i.head.coords,t=e.x,n=e.y,r=null,o=i.checkReverse()?i.direction:i.controls.direction;switch(o){case f.DIRECTION_LEFT:r=new h.default(t-i.field.cellSize,n);break;case f.DIRECTION_RIGHT:r=new h.default(t+i.field.cellSize,n);break;case f.DIRECTION_UP:r=new h.default(t,n-i.field.cellSize);break;case f.DIRECTION_DOWN:r=new h.default(t,n+i.field.cellSize)}if(i.controls.direction&&(i.app.started||(i.app.started=!0),!i.app.cellIntersectingWithObstacles(i,r))){var s=i.sideTravel(r);i.direction=o,i.eat(s)}}),this.app=t,this.field=this.app.field,this.controls=n,this.controls.app=t,this.body=[],this.baseSpeed=200-10*(u-1),this.minimumSpeed=20,this.direction=null,this.passed=0,this.toGrow=p,this.consumed=0,this.score=0,this.color=y,this.speedEasing=l()(.25,.46,.45,.94)}return s()(e,[{key:"tick",value:function(e){this.passed+=e,this.deTick(this.move)}},{key:"deTick",value:function(e){this.passed>=this.speed&&(this.passed=this.passed-this.speed,e(),this.deTick(e))}},{key:"spawn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=null!=e&&null!=t?new h.default(e,t):h.default.generate(this.app);this.body.push(new p.default(n))}},{key:"checkReverse",value:function(){return this.direction===f.DIRECTION_LEFT&&this.controls.direction===f.DIRECTION_RIGHT||this.direction===f.DIRECTION_RIGHT&&this.controls.direction===f.DIRECTION_LEFT||this.direction===f.DIRECTION_UP&&this.controls.direction===f.DIRECTION_DOWN||this.direction===f.DIRECTION_DOWN&&this.controls.direction===f.DIRECTION_UP}},{key:"addBody",value:function(e){this.body.unshift(new p.default(e))}},{key:"eat",value:function(e){this.addBody(e),this.feed(e)}},{key:"feed",value:function(e){var t=this.checkFoodInCoords(e);t&&(this.consumed++,this.score+=t.score,this.toGrow=t.power,t.destroy()),this.tailTrimmer()}},{key:"tailTrimmer",value:function(){if(this.toGrow)return this.toGrow--,!1;this.body.pop()}},{key:"checkFoodInCoords",value:function(e){var t=null;return this.app.food.forEach(function(n){t||n.coords.x===e.x&&n.coords.y===e.y&&(t=n)}),t}},{key:"sideTravel",value:function(e){var t,n,i=null;(e.x<0||e.x>=this.field.width||e.y<0||e.y>=this.field.height)&&(e.x<0&&(t=this.field.width-this.field.cellSize),e.y<0&&(n=this.field.height-this.field.cellSize),e.x>=this.field.width&&(t=0),e.y>=this.field.height&&(n=0),i=new h.default(t,n));return i||e}},{key:"speed",get:function(){var e=this.baseSpeed;if(this.consumed){var t=this.speedEasing(this.consumed/50);e=Math.round(this.baseSpeed-(this.baseSpeed-this.minimumSpeed)*t)}return e}},{key:"size",get:function(){return this.body.length}},{key:"head",get:function(){return this.body[0]}}]),e}()},function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return m});var i=n(0),r=n.n(i),o=n(1),s=n.n(o),u=n(8),a=n.n(u),c=n(9),l=n.n(c),d=n(10),f=n.n(d),h=n(5),p=n.n(h),v=n(4),y=n.n(v),k=n(3),m=function(e){function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=i.coords,s=void 0===o?k.default.generate(e):o,u=i.power,c=void 0===u?1:u,d=i.score,f=void 0===d?100:d;return r()(this,t),n=a()(this,l()(t).call(this,s)),y()(p()(p()(n)),"update",function(){n.hue+=n.hueStep*n.hueDirection,n.hue>255&&(n.hueDirection*=-1,n.hue=255),n.hue<0&&(n.hueDirection*=-1,n.hue=0),n.currentZoom+=n.zoomStep*n.zoomDirection,(n.zoomDirection&&n.currentZoom>=n.zoom||n.zoomDirection&&n.currentZoom<=-n.zoom)&&(n.zoomDirection=-1*n.zoomDirection),n.currentDegree+=n.degreeStep,n.currentDegree>=n.rotate&&(n.currentDegree=0)}),y()(p()(p()(n)),"draw",function(e){e.save(),e.translate(n.coords.x+n.app.field.cellSize/2,n.coords.y+n.app.field.cellSize/2),e.rotate(n.currentDegree*Math.PI/180),e.translate(-n.coords.x-n.app.field.cellSize/2,-n.coords.y-n.app.field.cellSize/2),e.fillStyle="hsl("+n.hue+",100%,50%)",e.fillRect(n.coords.x-n.currentZoom,n.coords.y-n.currentZoom,n.app.field.cellSize+2*n.currentZoom,n.app.field.cellSize+2*n.currentZoom),e.restore()}),n.app=e,n.power=c,n.score=f,n.hue=0,n.hueDirection=1,n.hueStep=3,n.zoom=1,n.currentZoom=0,n.zoomStep=.1,n.zoomDirection=1,n.rotate=360,n.currentDegree=0,n.degreeStep=1,n}return f()(t,e),s()(t,[{key:"destroy",value:function(){var e=this,t=null;this.app.food.forEach(function(n,i){n===e&&(t=i)}),this.app.food.splice(t,1)}}]),t}(n(7).default)},,function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=i=function(e){return n(e)}:e.exports=i=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},i(t)}e.exports=i},function(e,t){function n(t,i){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,i)}e.exports=n},function(e,t){var n=4,i=.001,r=1e-7,o=10,s=11,u=1/(s-1),a="function"==typeof Float32Array;function c(e,t){return 1-3*t+3*e}function l(e,t){return 3*t-6*e}function d(e){return 3*e}function f(e,t,n){return((c(t,n)*e+l(t,n))*e+d(t))*e}function h(e,t,n){return 3*c(t,n)*e*e+2*l(t,n)*e+d(t)}function p(e){return e}e.exports=function(e,t,c,l){if(!(0<=e&&e<=1&&0<=c&&c<=1))throw new Error("bezier x values must be in [0, 1] range");if(e===t&&c===l)return p;for(var d=a?new Float32Array(s):new Array(s),v=0;v<s;++v)d[v]=f(v*u,e,c);function y(t){for(var a=0,l=1,p=s-1;l!==p&&d[l]<=t;++l)a+=u;var v=a+(t-d[--l])/(d[l+1]-d[l])*u,y=h(v,e,c);return y>=i?function(e,t,i,r){for(var o=0;o<n;++o){var s=h(t,i,r);if(0===s)return t;t-=(f(t,i,r)-e)/s}return t}(t,v,e,c):0===y?v:function(e,t,n,i,s){var u,a,c=0;do{(u=f(a=t+(n-t)/2,i,s)-e)>0?n=a:t=a}while(Math.abs(u)>r&&++c<o);return a}(t,a,a+u,e,c)}return function(e){return 0===e?0:1===e?1:f(y(e),t,l)}}}]);